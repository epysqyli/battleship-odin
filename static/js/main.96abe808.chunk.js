(this["webpackJsonpbattleship-odin"]=this["webpackJsonpbattleship-odin"]||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),c=n(8),a=n.n(c),o=(n(13),n(3)),s=n(7),l=n(2),u=(n(14),n(0)),h=function(e){var t=e.coords,n=e.onCellClicked,r=e.clickable;return e.firstStageOver?t.ship?Object(u.jsx)("div",{className:t.ship.isSunk()?"cell sunk":t.attack?"cell hit":"cell clickable",onClick:n}):Object(u.jsx)("div",{className:t.miss?"cell miss":"cell clickable",onClick:n}):t.ship?Object(u.jsx)("div",{className:r?"cell ship":"cell ship clickable",onClick:n}):Object(u.jsx)("div",{className:r?"cell":"cell clickable",onClick:n})},f=(n(16),function(e){var t=e.owner,n=t.playerBoard.owner,r=t.playerBoard.board,i=e.getCellInfo,c=e.clickable,a=e.firstStageOver;return r.sort((function(e,t){return e.y>t.y?1:-1})),Object(u.jsxs)("div",{className:"gameboard-container",children:[Object(u.jsxs)("h2",{children:[n," gameboard"]}),Object(u.jsx)("div",{className:"gameboard",children:r.reverse().map((function(e,t){return Object(u.jsx)(h,{coords:e,owner:n,clickable:c,firstStageOver:a,onCellClicked:function(){return i(e)}},t)}))})]})}),d=function(e,t){var n=function(e){for(var t={},n=0;n<e;n++)t[n]="clear";return t}(t);return{name:e,length:t,direction:null,start:null,hitRecord:n,sunk:!1,hit:function(e){n[e]="hit"},isSunk:function(){return!!Object.values(n).every((function(e){return"hit"===e}))}}},b=(n(17),function(e){var t=Object(r.useState)([{unit:d("carrier",5),active:!1,placed:!1},{unit:d("battleship",4),active:!1,placed:!1},{unit:d("cruiser",3),active:!1,placed:!1},{unit:d("submarine",3),active:!1,placed:!1},{unit:d("destroyer",2),active:!1,placed:!1}]),n=Object(l.a)(t,2),i=n[0],c=n[1],a=e.chooseShip,s=e.hideShip;return Object(r.useEffect)((function(){s&&function(e,t){var n=Object(o.a)(i);n[t].placed=e,c(n)}(s[0],s[1])}),[s]),Object(u.jsxs)("div",{className:"ships-placement",children:[Object(u.jsx)("h2",{children:"place your ships on the board"}),Object(u.jsx)("p",{children:"Click on the ship first and then on the desired cell"}),Object(u.jsx)("div",{className:"ships",children:i.map((function(e,t){return e.placed?null:Object(u.jsxs)("div",{className:e.active?"ship-container selected-ship":"ship-container",onClick:function(){var n=Object(o.a)(i);n.map((function(e){return e.active=!1})),c(n),(n=Object(o.a)(i))[t]={unit:d(e.unit.name,e.unit.length),active:!0},c(n),a(e.unit,t)},children:[Object(u.jsx)("div",{className:"ship-name",children:e.unit.name}),Object(u.jsx)("div",{className:"unit-container",children:Object(o.a)(Array(e.unit.length)).map((function(e,t){return Object(u.jsx)("div",{className:"unit-cell"},t)}))})]},t)}))})]})}),j=[{carrier:d("carrier",5)},{battleship:d("battleship",4)},{cruiser:d("cruiser",3)},{submarine:d("submarine",3)},{destroyer:d("destroyer",2)}],p=[{carrier:d("carrier",5)},{battleship:d("battleship",4)},{cruiser:d("cruiser",3)},{submarine:d("submarine",3)},{destroyer:d("destroyer",2)}],O=function(e){for(var t=[],n=1,r=1;10!==n&&r<=10;){for(n=1;n<=10;)t.push({x:n,y:r,ship:null,miss:!1,attack:!1}),n++;r++}var i=function(e,n){return t.find((function(t){return t.x===e&t.y===n}))};return{board:t,owner:e,getCoords:i,placeShip:function(n,r,i,c){if(i>10||c>10)throw new Error("Either x or y are not valid coordinates");"player"===e?function(){var e=j.find((function(e){return e[n]})),a=e[n].length;if("horizontal"===r){if(i+a-1>10)throw new Error("Ship does not fit on the board")}else if("vertical"===r&&c+a-1>10)throw new Error("Ship does not fit on the board");if("horizontal"===r?function(){for(var e=[],n=function(n){t.forEach((function(t){t.x===i+n&&t.y===c&&e.push(t)}))},r=0;r<a;r++)n(r);if(e.some((function(e){return e.ship})))throw new Error("Path is not free")}():"vertical"===r&&function(){for(var e=[],n=0;n<a;n++)t.forEach((function(t){t.x===i&&t.y===c+1&&e.push(t)}));if(e.some((function(e){return e.ship})))throw new Error("Path is not free")}(),e[n].start={x:i,y:c},"horizontal"===r){e[n].direction="horizontal";for(var o=function(r){t.forEach((function(t){t.x===i+r&&t.y===c&&(t.ship=e[n])}))},s=0;s<a;s++)o(s)}else if("vertical"===r){e[n].direction="vertical";for(var l=function(r){t.forEach((function(t){t.x===i&&t.y===c+r&&(t.ship=e[n])}))},u=0;u<a;u++)l(u)}}():"computer"===e&&function(){var e=p.find((function(e){return e[n]})),a=e[n].length;if("horizontal"===r){if(i+a-1>10)throw new Error("Ship does not fit on the board")}else if("vertical"===r&&c+a-1>10)throw new Error("Ship does not fit on the board");if("horizontal"===r?function(){for(var e=[],n=function(n){t.forEach((function(t){t.x===i+n&&t.y===c&&e.push(t)}))},r=0;r<a;r++)n(r);if(e.some((function(e){return e.ship})))throw new Error("Path is not free")}():"vertical"===r&&function(){for(var e=[],n=0;n<a;n++)t.forEach((function(t){t.x===i&&t.y===c+1&&e.push(t)}));if(e.some((function(e){return e.ship})))throw new Error("Path is not free")}(),e[n].start={x:i,y:c},"horizontal"===r){e[n].direction="horizontal";for(var o=function(r){t.forEach((function(t){t.x===i+r&&t.y===c&&(t.ship=e[n])}))},s=0;s<a;s++)o(s)}else if("vertical"===r){e[n].direction="vertical";for(var l=function(r){t.forEach((function(t){t.x===i&&t.y===c+r&&(t.ship=e[n])}))},u=0;u<a;u++)l(u)}}()},receiveAttack:function(e,n){var r=i(e,n);if(r.miss||r.attack)throw new Error("Cell has already been hit");t.forEach((function(t){if(t.x===e&&t.y===n)if(t.ship){t.attack=!0;var r=t.ship;if("horizontal"===r.direction){var i=t.x-r.start.x;r.hit(i)}else if("vertical"===r.direction){var c=t.y-r.start.y;r.hit(c)}}else t.miss=!0}))},allSunk:function(){return t.filter((function(e){return e.ship})).every((function(e){return e.ship.isSunk()}))}}},v=function(e){var t=O(e);return{playerBoard:t,attack:function(e,t,n){n.playerBoard.receiveAttack(e,t)},chooseRandomCell:function(e){var t=Math.floor(10*Math.random())+1,n=Math.floor(10*Math.random())+1;return e.playerBoard.getCoords(t,n)},randomAttack:function(e,t,n){e.playerBoard.receiveAttack(t,n)},placeShipsDefault:function(){t.placeShip("carrier","horizontal",1,1),t.placeShip("battleship","vertical",2,5),t.placeShip("cruiser","vertical",4,7),t.placeShip("submarine","horizontal",6,6),t.placeShip("destroyer","horizontal",4,3)}}},m=(n(18),function(){var e=Object(r.useState)(v("player")),t=Object(l.a)(e,2),n=t[0],i=t[1],c=Object(r.useState)(v("computer")),a=Object(l.a)(c,2),h=a[0],d=a[1],j=Object(r.useState)(!1),p=Object(l.a)(j,2),O=p[0],m=p[1],x=Object(r.useState)(!1),y=Object(l.a)(x,2),S=y[0],k=y[1],w=Object(r.useState)(),E=Object(l.a)(w,2),g=E[0],C=E[1],N=Object(r.useState)({x:null,y:null}),z=Object(l.a)(N,2),B=z[0],A=z[1],I=Object(r.useState)(0),M=Object(l.a)(I,2),P=M[0],R=M[1],D=Object(r.useState)([!1,0]),J=Object(l.a)(D,2),T=J[0],q=J[1],F=Object(r.useState)("horizontal"),G=Object(l.a)(F,2),H=G[0],K=G[1],L=Object(r.useState)("player's turn"),Q=Object(l.a)(L,2),U=Q[0],V=Q[1],W=Object(r.useState)(!1),X=Object(l.a)(W,2),Y=X[0],Z=X[1],$=Object(r.useState)(!1),_=Object(l.a)($,2),ee=_[0],te=_[1],ne=Object(r.useState)(!1),re=Object(l.a)(ne,2),ie=re[0],ce=re[1],ae=Object(r.useState)(!1),oe=Object(l.a)(ae,2),se=oe[0],le=oe[1],ue=Object(r.useState)(null),he=Object(l.a)(ue,2),fe=he[0],de=he[1],be=Object(r.useState)([]),je=Object(l.a)(be,2),pe=je[0],Oe=je[1],ve=Object(r.useState)(null),me=Object(l.a)(ve,2),xe=me[0],ye=me[1],Se=function(){for(var e=h.chooseRandomCell(n);pe.includes(e);)e=h.chooseRandomCell(n);de(e);var t=Object(o.a)(pe);t.push(e),Oe(t)},ke=function(){xe&&console.log("".concat(xe," wins"))},we=function(){Se(),h.randomAttack(n,fe.x,fe.y),fe.ship?(le(!0),ce(!1),n.playerBoard.allSunk()&&(ye(h.playerBoard.owner),ke())):(le(!1),ce(!0),V("player's turn")),Z(!1)};return Object(r.useEffect)((function(){!function(){var e=Object(s.a)({},h);e.placeShipsDefault(),d(e)}(),Se()}),[]),Object(r.useEffect)((function(){g&&B&&function(e,t,r,c){var a,o=Object(s.a)({},n);o.playerBoard.placeShip(e,t,r,c),i(o),a=[!0,T[1]],q(a),C(null),A(null);var l=P;l++,R(l)}(g.name,H,B.x,B.y)}),[B]),Object(r.useEffect)((function(){S&&Y&&!ee&&setTimeout(we,1e3)}),[ee,Y]),Object(r.useEffect)((function(){ee&&Z(!0)}),[ee,Y]),Object(r.useEffect)((function(){se&&ie&&setTimeout(we,1e3)}),[se,ie]),Object(r.useEffect)((function(){se&&ce(!0)}),[se,ie]),Object(r.useEffect)((function(){5===P&&m(!0)}),[P]),S?Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("h1",{children:"Odin BattleShip"}),Object(u.jsxs)("div",{className:xe?"winner-box":"hidden",children:[Object(u.jsxs)("div",{children:[xe," has won - congrats!"]}),Object(u.jsx)("div",{className:"btn",onClick:function(){return i(v("player")),d(v("computer")),m(!1),k(!1),C(),A({x:null,y:null}),R(0),q([!1,0]),K("horizontal"),V("player's turn"),Z(!1),te(!1),ce(!1),le(!1),de(null),Oe([]),void ye(null)},children:"play again"})]}),Object(u.jsxs)("div",{className:xe?"container secondary":"container",children:[Object(u.jsx)(f,{owner:n,firstStageOver:S,getCellInfo:we}),Object(u.jsx)(f,{owner:h,firstStageOver:S,getCellInfo:function(e){n.attack(e.x,e.y,h),e.ship?(te(!0),Z(!1),h.playerBoard.allSunk()&&(ye(n.playerBoard.owner),ke()),V("player's turn")):(te(!1),Z(!0),V("computer's turn")),ce(!1)}})]}),Object(u.jsx)("div",{className:"turns-info",children:U})]}):Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("h1",{children:"Odin BattleShip"}),Object(u.jsxs)("div",{className:"container",children:[Object(u.jsx)(f,{owner:n,clickable:T[0],firstStage:S,getCellInfo:function(e){A({x:e.x,y:e.y})}}),Object(u.jsxs)("div",{className:"ships-component",children:[Object(u.jsx)(b,{owner:n,chooseShip:function(e,t){C(e),q([!1,t])},hideShip:T[0]?T:null}),Object(u.jsx)("div",{className:"direction-change",onClick:function(){K("horizontal"===H?"vertical":"horizontal")},children:"horizontal"===H?"horizontal":"vertical"})]})]}),Object(u.jsx)("div",{className:O?"game-start":"game-start hidden",onClick:function(){O&&k(!0)},children:"start game"})]})});a.a.render(Object(u.jsx)(i.a.StrictMode,{children:Object(u.jsx)(m,{})}),document.getElementById("root"))}],[[19,1,2]]]);
//# sourceMappingURL=main.96abe808.chunk.js.map